<!DOCTYPE html>
<html>
<head>
  <title>Chat</title>
  <%= stylesheet_link_tag    'application', media: 'all', 'data-turbolinks-track' => true %>
  <%= javascript_include_tag 'application', 'data-turbolinks-track' => true %>
  <%= csrf_meta_tags %>
</head>
<body>
<% if notice %>
    <div class="alert"><%= notice %></div>
<% end %>
<div class="content-fluid">
  <%= link_to 'На главную', root_path %>
  <% if @current_user %>
      <%= link_to 'Выход', {controller: :messages, action: :logout}, {class: :btn} %>
  <% end %>
  <div>
    <b class="label">Ваши каналы</b>
    <ul>
      <% if @current_user and @current_user.channels %>
          <% @current_user.channels.each do |channel| %>
              <li><%=private_channel_label(channel)%> <%= link_to channel.name, "/channels/#{channel.id}/chat" %> <%= link_to 'Редактировать', channel %></li>
          <% end %>
      <% end %>
    </ul>
  </div>
  <div>
    <b class="label">Каналы на которые вы подписаны</b>
    <ul>
      <% if @current_user and @current_user.subscribes %>
          <% @current_user.subscribes.each do |channel| %>
              <li><%=private_channel_label(channel)%> <%= link_to channel.name, "/channels/#{channel.id}/chat" %> <%= link_to 'Отписаться', "channels/#{channel.id}/unsubscribe" %></li>
          <% end %>
      <% end %>
    </ul>
  </div>
  <div>
    <b class="label">Популярные</b>
    <ul>
      <% @popular_channels.each do |channel| %>
          <li><%=channel.name%> <%= show_link_subscribe channel %></li>
      <% end %>
    </ul>
  </div>
  <div class="row_fluid">
    <div class="span4">
        <% if @current_user %>
          <%= link_to 'Создать канал', {controller: :channels, action: :new}, {class: :btn} %>
        <% end %>
    </div>
    <div class="span8">
        <%= yield %>
    </div>
  </div>
</div>

</body>
</html>
